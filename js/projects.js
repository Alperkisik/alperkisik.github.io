const projects = [
  {
    id: 0,
    show: true,
    name: "veritasedu.net",
    type: "Web Application",
    typeof: "w",
    status: "online",
    startdate: "Q3 2023",
    enddate: "Q1 2024",
    development: "self developed",
    case: "professional",
    company: {
      name: "Veritas Academy",
      websiteLink: "https://www.veritasedu.net",
    },
    summary: `This is the corporate website of Veritas Academy.
        It is commonly used by veritas academy's employees, teachers and students and it has many features for them.
        Mostly developed by me.`,
    websiteLink: "https://www.veritasedu.net",
    detailsLink: "./veritasedu.html",
    githubLink: "",
    imageSource: "./images/projects/veritas-academy/veritasedu/anasayfa-1.jpg",
    keywords: [
      ".Net Core",
      "C Sharp",
      "Asp.Net MVC 5",
      "Ado.Net",
      "Dapper",
      "HTML5",
      "JS",
      "CSS",
      "JQuery",
      "MS SQL",
      "REST API",
    ],
    imageGallery: [
      "./images/projects/veritas-academy/veritasedu/anasayfa-1.jpg",
      "./images/projects/veritas-academy/veritasedu/veritasedu-1.jpg",
      "./images/projects/veritas-academy/veritasedu/veritasedu-2.jpg",
      "./images/projects/veritas-academy/veritasedu/veritasedu-3.jpg",
      "./images/projects/veritas-academy/veritasedu/veritasedu-4.jpg",
      "./images/projects/veritas-academy/veritasedu/footer.jpg",
      "./images/projects/veritas-academy/veritasedu/login.jpg",
      "./images/projects/veritas-academy/veritasedu/studentportal-1.jpg",
      "./images/projects/veritas-academy/veritasedu/studentportal-2.jpg",
      "./images/projects/veritas-academy/veritasedu/questionbanks-1.jpg",
      "./images/projects/veritas-academy/veritasedu/questionbanks-2.jpg",
      "./images/projects/veritas-academy/veritasedu/questionbanks-3.png",
      "./images/projects/veritas-academy/veritasedu/questionbanks-4.png",
      "./images/projects/veritas-academy/veritasedu/exam-ap-1.png",
      "./images/projects/veritas-academy/veritasedu/exam-ap-1.png",
      "./images/projects/veritas-academy/veritasedu/exam-ap-3.jpg",
      "./images/projects/veritas-academy/veritasedu/exam-ap-4.jpg",
      "./images/projects/veritas-academy/veritasedu/exam-ap-3.jpg",
      "./images/projects/veritas-academy/veritasedu/exam-digital-sat.jpg",
      "./images/projects/veritas-academy/veritasedu/exam-random.jpg",
      "./images/projects/veritas-academy/veritasedu/sat-exam-result-screen.jpg",
      "./images/projects/veritas-academy/veritasedu/teacherportal-1.jpg",
      "./images/projects/veritas-academy/veritasedu/teacherportal-2.jpg",
      "./images/projects/veritas-academy/veritasedu/teacherportal-3.jpg",
      "./images/projects/veritas-academy/veritasedu/teacherportal-4.jpg",
      "./images/projects/veritas-academy/veritasedu/teacherportal-5.jpg",
      "./images/projects/veritas-academy/veritasedu/teacherportal-darkmode.jpg",
    ],
  },
  {
    id: 1,
    show: true,
    name: "consultancy.veritasedu.net",
    type: "Web App",
    typeof: "w",
    status: "online",
    startdate: "Q1 2023",
    enddate: "Q3 2023",
    development: "Contributed. Team Work",
    case: "professional",
    company: {
      name: "Veritas Academy",
      websiteLink: "https://www.veritasedu.net",
    },
    summary: `This website was created to meet the needs of Veritas Academy's consultants and streamline their workflow.
    Login required in order to use this web application.
    Contributed project. Worked in a team.`,
    websiteLink: "http://www.consultancy.veritasedu.net",
    detailsLink: "./consultancy-veritasedu.html",
    githubLink: "",
    imageSource: "./images/projects/veritas-academy/consultancy/c-1.png",
    keywords: [
      ".Net Core",
      "C Sharp",
      "Asp.Net MVC 5",
      "Ado.Net",
      "Entity Framework",
      "HTML5",
      "JS",
      "CSS",
      "JQuery",
      "MS SQL",
      "REST API",
    ],
    imageGallery: ["./images/projects/veritas-academy/consultancy/c-1.png"],
  },
  {
    id: 2,
    show: true,
    name: "belediye-sikayet.org",
    type: "Web App",
    typeof: "w",
    status: "offline",
    startdate: "Q4 2019",
    enddate: "Q1 2020",
    development: "self developed",
    case: "professional",
    company: {
      name: "Diji.Tech",
      websiteLink: "https://www.diji.tech/",
    },
    summary: `This website was developed as a prototype upon customer demands, but was not published.`,
    websiteLink: "",
    detailsLink: "./belediye-sikayet.html",
    githubLink: "",
    imageSource: "./images/projects/dijitech/belediyesikayet/anasayfa.png",
    keywords: [
      "Python",
      "Django",
      "Django Modelling",
      "HTML5",
      "JS",
      "CSS",
      "JQuery",
      "MS SQL",
      "REST API",
    ],
    imageGallery: [
      "./images/projects/dijitech/belediyesikayet/anasayfa.png",
      "./images/projects/dijitech/belediyesikayet/Desktop Ana Sayfa.png",
      "./images/projects/dijitech/belediyesikayet/Desktop Ana Sayfa 2.png",
      "./images/projects/dijitech/belediyesikayet/Desktop Ana Sayfa 3.png",
      "./images/projects/dijitech/belediyesikayet/Desktop Ana Sayfa Copy 3.png",
      "./images/projects/dijitech/belediyesikayet/Desktop Ana Sayfa Copy.png",
      "./images/projects/dijitech/belediyesikayet/Desktop Belediye Cevaplar.png",
      "./images/projects/dijitech/belediyesikayet/Desktop Belediye Detay.png",
      "./images/projects/dijitech/belediyesikayet/Desktop Belediye Listesi 2.png",
      "./images/projects/dijitech/belediyesikayet/Desktop Belediye Listesi Copy.png",
      "./images/projects/dijitech/belediyesikayet/Desktop Belediye Şikayet Başarı.png",
      "./images/projects/dijitech/belediyesikayet/Desktop Belediye Şikayet Oku.png",
      "./images/projects/dijitech/belediyesikayet/Desktop Belediye Şikayet Yaz.png",
      "./images/projects/dijitech/belediyesikayet/Desktop Etkinlikler Copy.png",
      "./images/projects/dijitech/belediyesikayet/Desktop Etkinlikler.png",
      "./images/projects/dijitech/belediyesikayet/Desktop Giriş Yap.png",
      "./images/projects/dijitech/belediyesikayet/Desktop Haberler Detay.png",
      "./images/projects/dijitech/belediyesikayet/Desktop Haberler.png",
      "./images/projects/dijitech/belediyesikayet/Desktop Hakkımızda.png",
      "./images/projects/dijitech/belediyesikayet/Desktop Harita Detay.png",
      "./images/projects/dijitech/belediyesikayet/Desktop İletişim.png",
      "./images/projects/dijitech/belediyesikayet/Desktop Kullanım Koşulları.png",
      "./images/projects/dijitech/belediyesikayet/Desktop Sıkça Sorulan Sorular.png",
      "./images/projects/dijitech/belediyesikayet/Desktop Tablet İl Detay.png",
      "./images/projects/dijitech/belediyesikayet/Desktop Üye Ol.png",
      "./images/projects/dijitech/belediyesikayet/Desktop Yan Menu.png",
      "./images/projects/dijitech/belediyesikayet/Profilim.png",
      "./images/projects/dijitech/belediyesikayet/Şifremi Unuttum.png",
    ],
  },
  {
    id: 3,
    show: true,
    name: "Veritas Questions",
    type: "Desktop App",
    typeof: "d",
    status: "offline",
    startdate: "Q4 2019",
    enddate: "Q1 2020",
    development: "Contributed. Team Work",
    case: "professional",
    company: {
      name: "Veritas Academy",
      websiteLink: "https://www.veritasedu.net",
    },
    summary: `This is a desktop automation application created for building and editing Veritas Academy Digital Questionbank Archive.
    Contributed Project.`,
    websiteLink: "",
    detailsLink: "./veritas-questions.html",
    githubLink: "",
    imageSource: "./images/projects/veritas-academy/veritas-questions/ib-1.jpg",
    keywords: [
      ".Net Core",
      "C Sharp",
      "Windows Form Application",
      "Ado.Net",
      "Entity Framework",
      "MS SQL",
    ],
  },
  {
    id: 4,
    show: true,
    name: "Warhammer Fantasy Card Battles",
    type: "Desktop App",
    typeof: "d",
    status: "online",
    startdate: "Q3 2018",
    enddate: "Q3 2018",
    development: "self developed",
    case: "case study",
    company: {
      name: "self",
      websiteLink: "",
    },
    summary: `This is a desktop application turn based card game includes warhammer fantasy universe.
    I created this game just for fun. Game currently available on my github.`,
    websiteLink: "",
    detailsLink: "./warhammer-fantasy-card-battles.html",
    githubLink:
      "https://github.com/Alperkisik/Warhammer-Fantasy-Battles-Card-Game",
    imageSource: "./images/projects/my-projects/warhammer/warhammer.webp",
    keywords: [".Net Core", "C Sharp", "Windows Form Application"],
    imageGallery: [
      "./images/projects/my-projects/warhammer/warhammer.webp",
      "./images/projects/my-projects/warhammer/w-1.webp",
      "./images/projects/my-projects/warhammer/w-1-1.webp",
      "./images/projects/my-projects/warhammer/w-1-2.webp",
      "./images/projects/my-projects/warhammer/w-1.webp",
      "./images/projects/my-projects/warhammer/w-2.webp",
      "./images/projects/my-projects/warhammer/w-3.webp",
      "./images/projects/my-projects/warhammer/w-4.webp",
    ],
  },
  {
    id: 4,
    show: true,
    name: "Crew Party",
    type: "Mobile App",
    typeof: "m",
    status: "offline",
    startdate: "Q4 2021",
    enddate: "Q4 2021",
    development: "self developed",
    case: "professional",
    company: {
      name: "Pasatempos Games",
      websiteLink: "https://www.instagram.com/pasatemposgames/",
    },
    summary: `This is a hyper casual game prototype. Almost published by Rolic Games.
    Created by me.`,
    websiteLink: "",
    detailsLink: "./crew-party.html",
    githubLink: "",
    imageSource: "./images/projects/pasatempos/crew-party-1.png",
    keywords: ["Unity Game Engine", "C Sharp", ".Net"],
  },
  {
    id: 5,
    show: true,
    name: "Titions",
    type: "Mobile App",
    typeof: "m",
    status: "offline",
    startdate: "Q4 2021",
    enddate: "Q4 2021",
    development: "self developed",
    case: "professional",
    company: {
      name: "Pasatempos Games",
      websiteLink: "https://www.instagram.com/pasatemposgames/",
    },
    summary: `This is a hyper casual game prototype. Almost published by Rolic Games.
    Created by me.`,
    websiteLink: "",
    detailsLink: "./titions.html",
    githubLink: "",
    imageSource: "./images/projects/pasatempos/titions-1.png",
    keywords: ["Unity Game Engine", "C Sharp", ".Net"],
  },
  {
    id: 6,
    show: true,
    name: "Yolcu.com",
    type: "Web App",
    typeof: "w",
    status: "online",
    startdate: "Q1 2020",
    enddate: "Q3 2020",
    development: "Contributed. Team Work",
    case: "professional",
    company: {
      name: "Diji.Tech",
      websiteLink: "https://www.diji.tech/",
    },
    summary: `This is a web application created by diji.tech developers.
    I am just contributed on front-end part.`,
    websiteLink: "https://www.yolcu.com",
    detailsLink: "",
    githubLink: "",
    imageSource: "./images/projects/dijitech/yolcu/y-1.png",
    keywords: [
      "Python",
      "Django",
      "Django Modelling",
      "HTML5",
      "JS",
      "CSS",
      "JQuery",
      "MS SQL",
      "REST API",
    ],
  },
  {
    id: 7,
    show: true,
    name: "Go Game",
    type: "Desktop App",
    typeof: "d",
    status: "offline",
    startdate: "Q2 2012",
    enddate: "Q2 2012",
    development: "Contributed. Team Work.",
    case: "professional",
    company: {
      name: "self",
      websiteLink: "",
    },
    summary: `This is a Windows Form Application game based on Go Game from far East Culture.
    Developed as a high school graduation project. I lead a team with 2 other students.
    I designed and developed all game logic behind. We decided user interface and database designs as a team. 
    Due to very old version of .Net and sqlce library no longer available, this application is no longer available.`,
    websiteLink: "",
    detailsLink: "./go-game.html",
    githubLink: "https://github.com/Alperkisik/The-Go-Game",
    imageSource: "./images/projects/my-projects/go/go-1.webp",
    keywords: [
      ".Net",
      "MS SqlCe",
      "MS Sql lite",
      "C Sharps",
      "Windows Form Application",
      "Ado.Net",
    ],
    imageGallery: [
      "./images/projects/my-projects/go/go-1.webp",
      "./images/projects/my-projects/go/go-2.webp",
      "./images/projects/my-projects/go/go-3.webp",
      "./images/projects/my-projects/go/go-4.webp",
      "./images/projects/my-projects/go/go-5.webp",
    ],
  },
];

const sortDataByQuarterYear = () => {
  return projects.sort(function (a, b) {
    // endDate değerlerini al ve tersine çevir
    var endDateA =
      a.enddate.split(" ")[1] + a.enddate.split(" ")[0].replace("Q", "");
    var endDateB =
      b.enddate.split(" ")[1] + b.enddate.split(" ")[0].replace("Q", "");

    // String olarak karşılaştırma yap
    return endDateB.localeCompare(endDateA);
  });
};

const truncateString = (str) => {
  var maxLength = 200;
  if (str.length > maxLength) {
    var truncatedStr = str.slice(0, maxLength) + ".....";
    return truncatedStr;
  } else {
    return str;
  }
};

const createProjects = () => {
  const projectsGrid = document.getElementById("projectsGrid");

  const sortedProjects = sortDataByQuarterYear();

  projectsGrid.innerHTML = "";
  sortedProjects.forEach((project) => {
    let date = project.startdate;
    if (project.enddate !== date) date += ` to ${project.enddate}`;

    let buttonContainer = `<div class="button-container">`;
    if (project.detailsLink.length > 0) {
      buttonContainer += `<a class="cstm-btn-purple" href="${project.detailsLink}">More Info</a>`;
    }

    if (project.websiteLink.length > 0) {
      buttonContainer += `<a class="cstm-btn-blue" href="${project.websiteLink}" target="_blank">Go to website</a>`;
    } else if (
      (project.websiteLink.length === 0) &
      (project.githubLink.length > 0)
    ) {
      buttonContainer += `<a class="cstm-btn-blue" href="${project.githubLink}" target="_blank">Download From</a>`;
    }

    buttonContainer += "</div>";

    if (
      (project.detailsLink.length === 0) &
      (project.websiteLink.length === 0) &
      (project.githubLink.length === 0)
    )
      buttonContainer = "";

    let projectHtml = `
          <div class="grid-item" name="project" p-typeof="${project.typeof}">
              <img src="${project.imageSource}" alt="${project.name} project">
              <div class="overlay">
                  <div>
                      <h3>${project.name}</h3>
                      <h4>${project.type}</h4>
                  </div>
                  <div class="d-flex flex-row flex-wrap gap-2">
                      <div class="status-badge">
                          Status: <span class="status-${project.status}">${
      project.status
    }</span>
                      </div>
                      <div class="status-badge">
                          ${date}
                      </div>
                  </div>
                  <p>
                      ${truncateString(project.summary)}
                  </p>
                  ${buttonContainer}
              </div>
          </div>
          `;

    projectsGrid.innerHTML += projectHtml;
  });
};

const filterBy = (filter) => {
  var elements = document.querySelectorAll('div[name="project"]');

  elements.forEach((element) => {
    setTimeout(() => {
      element.classList.remove("d-none");
      element.style.opacity = "1";
      element.style.height = "auto";
      element.style.maxWidth = "100%";
    }, 500);

    if (element.getAttribute("p-typeof") !== filter) {
      element.style.opacity = "0";
      setTimeout(() => {
        element.style.height = "0";
        element.style.maxWidth = "0";
        element.classList.add("d-none");
      }, 500);
    }
  });
};

const showAll = () => {
  var elements = document.querySelectorAll('div[name="project"]');
  elements.forEach((element) => {
    if (element.classList.contains("d-none")) {
      element.classList.remove("d-none");
      element.style.opacity = "0";
      element.style.height = "0";
      element.style.maxWidth = "0";

      setTimeout(() => {
        element.style.opacity = "1";
        element.style.height = "auto";
        element.style.maxWidth = "100%";
      }, 500);
    }
  });
};

const setupClickEvent = () => {
  const listItems = document.querySelectorAll(".sorting-list li");

  listItems.forEach((item) => {
    item.addEventListener("click", function () {
      if (this.classList.contains("active") === true) {
        return;
      }

      listItems.forEach((li) => {
        li.classList.remove("active");
      });

      this.classList.add("active");

      let filter = this.getAttribute("data-p");
      if (filter === "all") showAll();
      else filterBy(filter);
    });
  });
};

const setupGallery = (project) => {
  if (project.imageGallery === null || project.imageGallery === undefined) {
    document.getElementById("project-img-gallery").remove();
    return;
  }

  const imageGallery = document.createElement("div");
  imageGallery.classList = "gallery";

  project.imageGallery.forEach((imageSrc) => {
    const img = document.createElement("img");
    img.src = imageSrc;

    imageGallery.append(img);
  });

  document.getElementById("project-img-gallery").append(imageGallery);

  imageGallery.addEventListener("click", function (event) {
    if (event.target.tagName === "IMG") {
      $("#imageModal").modal("toggle");

      document.getElementById("modalImage").src =
        event.target.getAttribute("src");
    }
  });
};

const setupKeywords = (project) => {
  const keywords = document.getElementById("project-keywords");
  project.keywords.forEach((keyword) => {
    const li = document.createElement("li");
    li.innerHTML = keyword;

    keywords.append(li);
  });
};

const setupMainImage = (imageSource) => {
  document.getElementById("projectMainImage").setAttribute("src", imageSource);
};

const setupTitle = (project) => {
  const headers = document.getElementById("headers");

  let titleHtml = `<h1 class="theme-title-1 color-fushia-2 mb-2" id="projectTitle">${project.name}</h1>`;

  let companyHtml = `
        <h2 class="theme-title-2" id="projectType">
            <span class="color-blue">Company : </span>
            <a href="${project.company.websiteLink}" target="_blank" >${project.company.name}</a>
        </h2>`;

  if (project.company.name === "self")
    companyHtml = `<h2 class="theme-title-2 color-blue" id="projectType">Case Study</h2>`;

  headers.innerHTML += titleHtml;
  headers.innerHTML += companyHtml;
  headers.innerHTML += `<h3 class="theme-title-3"><span class="color-blue">Development Process : </span>${project.development}</h3>`;
};

const setupStatusDateLinkSummary = (project) => {
  const statusBadge = document.getElementById("status-badge");
  statusBadge.classList = `status-${project.status}`;
  statusBadge.innerHTML = project.status;

  let date = "Date : " + project.startdate;
  if (project.enddate !== date) date += ` to ${project.enddate}`;
  document.getElementById("date-badge").innerHTML = date;

  if (project.websiteLink.length > 0) {
    const btn = document.getElementById("gotowebsiteBtn");
    btn.setAttribute("href", project.websiteLink);
  } else {
    document.getElementById("gotowebsiteBtn").remove();
  }

  if (project.githubLink.length > 0) {
    const btn = document.getElementById("gotogithubBtn");
    btn.setAttribute("href", project.githubLink);
  } else {
    document.getElementById("gotogithubBtn").remove();
  }

  document.getElementById("summary").innerHTML = project.summary;
};

document.addEventListener("DOMContentLoaded", function () {
  const currentPageUrl = window.location.href;
  const urlParts = currentPageUrl.split("/");

  let urlLastPart = urlParts[urlParts.length - 1];
  if (urlLastPart.includes("#")) urlLastPart = urlLastPart.split("#")[0];

  if (urlLastPart.length === 0 || urlLastPart.includes("index.html")) {
    setupClickEvent();
    createProjects();

    return;
  }

  const project = projects.find((item) => {
    let detailsLink = item.detailsLink.replace("./", "");
    return urlLastPart === detailsLink;
  });

  setupMainImage(project.imageSource);
  setupTitle(project);
  setupKeywords(project);
  setupStatusDateLinkSummary(project);
  setupGallery(project);

  //meta title
  document.title = project.name + " Project";
  var metaTag = document.querySelector('meta[name="title"]');
  metaTag.setAttribute("content", "Alper Kısık Portfolio | " + document.title);

  //meta keywords
  var metaKeywords = document.querySelector('meta[name="keywords"]');
  let keywords = "Alper Kısık, software developer portfolio, " + project.name;
  metaKeywords.setAttribute("content", keywords);

  //meta description
  var metaDescription = document.querySelector('meta[name="description"]');
  let description = project.summary;
  metaDescription.setAttribute("content", description);
});
